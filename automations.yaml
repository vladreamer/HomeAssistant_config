#
#
#
- id: 'AllDimmersOFF_20190213'
########################################################
## All Light OFF at 00:00am 
########################################################
  alias: "LightScene Dimmers AllRooms OFF at 00:00"
  initial_state: true
  trigger:
    - platform: time
      at: '00:00:00'
  action:
    ## MasterRoom Dimmer Id:29
  - service: homeassistant.turn_off
    entity_id: light.zooz_zen22_dimmer_v2_1_level
    ## VladsRoom Dimmer Id:32
  - service: homeassistant.turn_off
    entity_id: light.zooz_zen22_dimmer_v2_2_level
    ## ChatRoom Dimmer Id:42
  - service: homeassistant.turn_off
    entity_id: light.zooz_zen22_dimmer_v2_3_level
    ## Basement Stairs Id:24
  - service: homeassistant.turn_off
    entity_id: switch.zooz_zen21_switch_v20_switch_01
#
# 
#
- id: 'ChatRoomLightON_20190213'
########################################################
## ChatRoom Light with Zen22 ID:42 at 8:30pm ON 
########################################################
  alias: "LightScene Dimmer ChatRoom 20:30-22:30"
  initial_state: true 
  trigger:
  - platform: sun
    event: sunset
    offset: "-00:05:00"
# - platform: time
#   at: '20:30:00'
  condition:
  - condition: state
    entity_id: light.zooz_zen22_dimmer_v2_3_level 
    state: 'off'
  action:
  - service: scene.turn_on
    entity_id: scene.lightlow_chatroom
#
#
#
- id: 'ChatRoomLightOFF_20190213'
########################################################
## ChatRoom Light with Zen22 ID:42 at 22:30pm OFF 
########################################################
  alias: "LightScene Dimmer ChatRoom OFF at 22:30"
  initial_state: true
  trigger:
    - platform: time
      at: '22:30:00'
  condition:
  - condition: state
    entity_id: light.zooz_zen22_dimmer_v2_3_level
    state: 'on'
  action:
  - service: homeassistant.turn_off
    entity_id: light.zooz_zen22_dimmer_v2_3_level
#
# 
#
- id: 'ModemReboot_20190113'
########################################################
## Reboot modem connected to Neo05 ID:33 at 5:00am 
########################################################
  alias: "Modem reboot at 5:00"
  initial_state: true
  trigger:
    - platform: time
      at: '05:00:00'
  condition:
  - condition: state
    entity_id: switch.neo_coolcam_power_plug_12a_switch05
    state: 'on'
  action:
  - service: homeassistant.turn_off 
    entity_id: switch.neo_coolcam_power_plug_12a_switch05
  - delay: '00:00:03'
  - service: homeassistant.turn_on
    entity_id: switch.neo_coolcam_power_plug_12a_switch05
#
#
# 
- id: 'PorchLightON_20181216'
########################################################
## Porch Light with Neo10 ID:?? at 6:00pm ON 
########################################################
  alias: "PorchLight ON at 18:00"
  initial_state: false
  trigger:
    - platform: time
      at: '18:00:00'
  condition:
  - condition: state
    entity_id: switch.neo_coolcam_power_plug_12a_switch10
    state: 'off'
  action:
  - service: homeassistant.turn_on 
    entity_id: switch.neo_coolcam_power_plug_12a_switch10
# - service: homeassistant.turn_on 
#   entity_id: switch.intermatic_ha02_appliance_module_switch
#
#
- id: 'PorchLightOFF_20181216'
########################################################
## Porch Light with Neo10 ID:?? at 23:00pm OFF 
########################################################
  alias: "PorchLight OFF at 23:00"
  initial_state: false
  trigger:
    - platform: time
      at: '23:00:00'
  condition:
  - condition: state
    entity_id: switch.neo_coolcam_power_plug_12a_switch10
    state: 'on'
  action:
  - service: homeassistant.turn_off 
    entity_id: switch.neo_coolcam_power_plug_12a_switch10
# - service: homeassistant.turn_off 
#   entity_id: switch.intermatic_ha02_appliance_module_switch
#
#

- id: 'LightSceneVladsRoom_20181106'
########################################################
## LightScene in Vlad's Room 
## Turn Dimmer Switch (VladsRoom ID:29) "ON" with 55 brightness 
## if it was "OFF" triggered by Multisensor3 after 6pm
########################################################
  alias: "LightScene Dimmer VladRoom 18:00-21:00"
  initial_state: false
  trigger:
    - entity_id: binary_sensor.multi03_motion
      platform: state
      to: 'on'
  condition:
    - condition: time
      after: '18:00:00'
      before: '21:00:00'
    - condition: state
      entity_id: light.zooz_zen22_dimmer_v2_2_level 
      state: 'off'
  action:
     service: scene.turn_on
     entity_id: scene.lightlow_vlad

- id: 'LighSceneVladsRoom_OFF_20181106'
########################################################
## Turn Dimmer switch (ID:29) "OFF" if it was "ON" triggered by
## Multisensor3 after 15 minutes "NO MOTION" after 10:30pm
########################################################
  alias: "LightScene Dimmer VladRoom OFF in 15min after 21:30"
  initial_state: true
  trigger:
  - entity_id: binary_sensor.multi03_motion
    for:
      minutes: 15
    platform: state
    to: 'off'
  condition:
    - condition: time
      after: '21:30:00'
    - condition: state
      entity_id: light.zooz_zen22_dimmer_v2_2_level
      state: 'on'
  action:
  - service: homeassistant.turn_off
    entity_id: light.zooz_zen22_dimmer_v2_2_level

- id: 'ThermostatUpdate_2018112800'
########################################################
## Thermostat (ID:28) 
########################################################
  alias: Thermostat Refresh Timer
  initial_state: true
  trigger:
  - platform: time_pattern
    seconds: '/30'
  condition: []
  action:
  - data:
     entity_id: climate.2gig_technologies_ct101_thermostat_iris_heating_1 
    service: zwave.refresh_entity


- id: 'TempMorning_2018111400'
########################################################
## Thrmostat (ID:28) 
########################################################
  alias: "TEMP 22C Morn. 7:15-9:00"
  initial_state: false
  trigger:
    - platform: template
      value_template: "{% if states('sensor.2gig_technologies_ct101_thermostat_iris_temperature') | float < 22 %} true {% endif %}"
    - platform: time
      at: '07:15:00'
  condition:
    - condition: time
      after: '07:15:00'
      before: '08:59:00'
  action:
    - service: homeassistant.turn_on 
      ## Neo08 (ID: 47) 
      entity_id: switch.neo_coolcam_power_plug_12a_switch08
    - service: climate.set_temperature
      data:
       entity_id: climate.2gig_technologies_ct101_thermostat_iris_heating_1
       temperature: 22
       operation_mode: Heat
    - service: notify.mailtogmail
      data_template:
        title: "Morning Temperature to 22C {{ now().strftime('%d %b, %Y %-I:%M %P') }}"
        message: "Current Temperature is {{ states('sensor.2gig_technologies_ct101_thermostat_iris_temperature') }}"

        
- id: 'TempDay_2018111400'
########################################################
## Thrmostat (ID:28) 
########################################################
  alias: "TEMP 21C Day 9:00-17:30"
  initial_state: false
  trigger:
    - platform: template
      value_template: "{% if states('sensor.2gig_technologies_ct101_thermostat_iris_temperature') | float > 21.5 %} true {% endif %}"
    - platform: template
      value_template: "{% if states('sensor.2gig_technologies_ct101_thermostat_iris_temperature') | float < 20.5 %} true {% endif %}"
    - platform: time
      at: '09:00:00'    
  condition:
    - condition: time
      after: '09:00:00'
      before: '17:29:00'
  action:
    - service: homeassistant.turn_off
      ## Neo08 (ID: 47)
      entity_id: switch.neo_coolcam_power_plug_12a_switch08
    - service: climate.set_temperature
      data:
       entity_id: climate.2gig_technologies_ct101_thermostat_iris_heating_1
       temperature: 21
       operation_mode: Heat
    - service: notify.mailtogmail
      data_template:
        title: "Day Temperature to 21C {{ now().strftime('%d %b, %Y %-I:%M %P') }}"
        message: "Current Temperature is {{ states('sensor.2gig_technologies_ct101_thermostat_iris_temperature') }}"
        
- id: 'TempEve_2018111400'
########################################################
## Thrmostat (ID:28) 
########################################################
  alias: "TEMP 22C Eve. 17:30-22:30"
  initial_state: false
  trigger:
    - platform: template
      value_template: "{% if states('sensor.2gig_technologies_ct101_thermostat_iris_temperature') | float < 22 %} true {% endif %}"
    - platform: time
      at: '17:30:00'    
  condition:
    - condition: time
      after: '17:30:00'
      before: '22:29:00'
  action:
   #- service: homeassistant.turn_on 
   #  entity_id: switch.neo_coolcam_power_plug_12a_switch08
    - service: climate.set_temperature
      data:
       entity_id: climate.2gig_technologies_ct101_thermostat_iris_heating_1
       temperature: 22
       operation_mode: Heat
    - service: notify.mailtogmail
      data_template:
        title: "Evening Temperature to 22C {{ now().strftime('%d %b, %Y %-I:%M %P') }}"
        message: "Current Temperature is {{ states('sensor.2gig_technologies_ct101_thermostat_iris_temperature') }}"
        
- id: 'TempNight_2018111400'
########################################################
## Thrmostat (ID:28) 
########################################################
  alias: "TEMP 20C Night 22:30-7:15" 
  initial_state: false
  trigger:
    - platform: template
      value_template: "{% if states('sensor.2gig_technologies_ct101_thermostat_iris_temperature') | float > 20.5 %} true {% endif %}"
    - platform: template
      value_template: "{% if states('sensor.2gig_technologies_ct101_thermostat_iris_temperature') | float < 19.5 %} true {% endif %}"
    - platform: time
      at: '22:30:00'    
  condition:
    - condition: time
      after: '22:30:00'
      before: '07:14:00'
  action:
    - service: homeassistant.turn_off
      ## Neo08 (ID: 47)
      entity_id: switch.neo_coolcam_power_plug_12a_switch08
    - service: climate.set_temperature
      data:
       entity_id: climate.2gig_technologies_ct101_thermostat_iris_heating_1
       temperature: 20
       operation_mode: Heat
    - service: notify.mailtogmail
      data_template:
        title: "Night Temperature to 20C {{ now().strftime('%d %b, %Y %-I:%M %P') }}"
        message: "Current Temperature is {{ states('sensor.2gig_technologies_ct101_thermostat_iris_temperature') }}"


- id: 'VladsRoomSW_Timer_2019070200'
########################################################
## VladsRoomSW for ventilation during the night  (ID:12) 
########################################################
  alias: "VladsRoomSW_Timer ON/OFF hour 8:00-22:30" 
  initial_state: true
  trigger:
   - platform: time
     at: '08:00:00'    
  condition:
   - condition: time
     after: '07:59:00'
     before: '22:31:00'
  action:
   - service: homeassistant.turn_on
     entity_id: switch.neo_coolcam_power_plug_12a_switch03
   - delay: 14:30:00
   - service: homeassistant.turn_off
     entity_id: switch.neo_coolcam_power_plug_12a_switch03

- id: 'VentilationNight_2019062700'
########################################################
## HRV unit for ventilation during the night  (ID:47) 
########################################################
  alias: "Ventilation 15min every hour 1:00-6:00" 
  initial_state: true
  trigger:
   - platform: time_pattern       
     minutes: '/60'
     seconds: 0
  condition:
   - condition: time
     after: '1:00:00'
     before: '06:00:00'
  action:
   - service: homeassistant.turn_on
     entity_id: switch.neo_coolcam_power_plug_12a_switch08
   - delay: 00:15:00
   - service: homeassistant.turn_off
     entity_id: switch.neo_coolcam_power_plug_12a_switch08
    
    
- id: 'ResetEnergySensors_2018110500'
########################################################
## Reset Home Energy Meter (ID:25) monthly consumption 
########################################################
  alias: Reset HEM (ID:25) monthly 
  initial_state: true
  trigger:
      platform: time
      at: "00:00:00"
  condition:
     condition: template
     value_template: "{{ now().date().day == 1 }}" 
  action:
    - service: notify.mailtogmail
      data_template:
        title: "Energy iused {{states.sensor.aeotec_zw095_home_energy_meter_gen5_energy.state}} kWh"
        message: "Total Energy Used per month is {{states.sensor.aeotec_zw095_home_energy_meter_gen5_energy.state}} kWh
    
        ID:39 - FurnaceSW - {{states.sensor.aeotec_zw078_heavy_duty_smart_switch_gen5_energy.state}} kWh;
    
        ID:21 - GreatRoomSW - {{states.sensor.hank_hkzwso03_smart_plug_energy01.state}} kWh;
        
        ID:8  - Solar Panel - {{states.sensor.neo_coolcam_power_plug_12a_energy01.state}} kWh;
        
        ID:10 - KitchenSW - {{states.sensor.neo_coolcam_power_plug_12a_energy02.state}} kWh;
        
        ID:12 - Vlad'sRoomSW - {{states.sensor.neo_coolcam_power_plug_12a_energy03.state}} kWh;
        
        ID:14 - ChatRoomSW - {{states.sensor.neo_coolcam_power_plug_12a_energy04.state}} kWh;
        
        ID:33 - ModemSW - {{states.sensor.neo_coolcam_power_plug_12a_energy05.state}} kWh;
       
        ID:40 - OfficeSW - {{states.sensor.neo_coolcam_power_plug_12a_energy06.state}} kWh;
        
        ID:41 - Neo07SW - {{states.sensor.neo_coolcam_power_plug_12a_energy07.state}} kWh;
       
        ID:47 - HRV_SW - {{states.sensor.neo_coolcam_power_plug_12a_energy08.state}} kWh;
        
        ID:44 - ChatRoomRight - {{states.sensor.dome_on_off_plug_in_switch01_energy.state}} kWh;
        
        ID:46 - Dome02 - {{states.sensor.dome_on_off_plug_in_switch02_energy.state}} kWh;"
        
   
    - service: zwave.reset_node_meters 
      data: {"node_id": 25}
    - service: zwave.reset_node_meters 
      data: {"node_id": 21}
    - service: zwave.reset_node_meters 
      data: {"node_id": 8}
    - service: zwave.reset_node_meters 
      data: {"node_id": 10}
    - service: zwave.reset_node_meters 
      data: {"node_id": 12}
    - service: zwave.reset_node_meters 
      data: {"node_id": 14}
    - service: zwave.reset_node_meters 
      data: {"node_id": 33}
    - service: zwave.reset_node_meters 
      data: {"node_id": 39}
    - service: zwave.reset_node_meters 
      data: {"node_id": 40}
    - service: zwave.reset_node_meters 
      data: {"node_id": 41}
    - service: zwave.reset_node_meters 
      data: {"node_id": 47}
    - service: zwave.reset_node_meters 
      data: {"node_id": 44}
    - service: zwave.reset_node_meters 
      data: {"node_id": 46}
    


- id: 'LightSceneMasterRoom_2018082601'
########################################################
## Turn Light ON MAsterBedroom if it was "OFF" triggered by
## Multisensor4 ID:19 After that take 4 snapshoots and send
## them by mail "notify.mailtogmail"
########################################################
  alias: "LightScene Dimmer MasterRoom 18:00-22:00"
  initial_state: false
 #alias: Inolelli01SW2 ON before 22:50 
  trigger:
    - entity_id: binary_sensor.multi04_motion
      platform: state
      to: 'on'
  condition:
    - condition: time
      after: '18:00:00'
      before: '22:00:00'
      #weekday:
      #- mon  
      #- tue
      #- wed
      #- thu
      #- fri     
    - condition: state
      #entity_id: switch.inovelli_2ch_01_2
      entity_id: light.zooz_zen22_dimmer_v2_1_level 
      state: 'off'
  action:
   #- service: homeassistant.turn_on
   #  entity_id: switch.inovelli_2ch_01_2
     service: scene.turn_on
     entity_id: scene.lightlow_master


- id: 'LightSeceneMasterRoom_OFF_2018082602'
########################################################
## Turn Dimmer "OFF" if it was "ON" triggered by
## Multisensor4 after 15 minutes "NO MOTION"
##
########################################################
  alias: "LightScene Dimmer MasterRoom OFF in 15min"
  initial_state: true
 #alias: Inovelli01SW2 OFF after 15min
  trigger:
  - entity_id: binary_sensor.multi04_motion
    for:
      minutes: 15
    platform: state
    to: 'off'
  condition:
  - condition: state
    #entity_id: switch.inovelli_2ch_01_2
    entity_id: light.zooz_zen22_dimmer_v2_1_level
    state: 'on'
  action:
  - service: homeassistant.turn_off
    #entity_id: switch.inovelli_2ch_01_2
    entity_id: light.zooz_zen22_dimmer_v2_1_level
#
#
#
#
- id: 'GarageDoor_Open' 
########################################################
## Garage door "OPEN" if it was "OFF" triggered by 
## GarageDoor sensor ID:35 After that take 4 snapshoots and send
## them by mail "notify.mailtogmail" 
########################################################
  alias: Garage Door is OPEN
  initial_state: true
  trigger:
    - entity_id: binary_sensor.ecolink_garage_door_tilt_sensor_sensor
      platform: state
      to: 'on'
  action:
    - service: camera.snapshot
      data:
        entity_id: camera.camera4
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera4_01.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera4_01.jpg"
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera4_01cor.jpg"
    - delay: '00:00:10'
    - service: camera.snapshot
      data:
        entity_id: camera.camera4
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera4_02.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera4_02.jpg"
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera4_02cor.jpg"
    - delay: '00:00:20'
    - service: camera.snapshot
      data:
        entity_id: camera.camera4
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera4_03.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera4_03.jpg"
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera4_03cor.jpg"
    - delay: '00:00:30'
    - service: camera.snapshot
      data:
        entity_id: camera.camera4
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera4_04.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera4_04.jpg"
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera4_04cor.jpg"
    - service: notify.mailtogmail
      data_template:
        title: "Garage Door is OPEN"
        message: "Someone opened Garage Door"
        data:
          images:
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera4_01cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera4_02cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera4_03cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera4_04cor.jpg
          html: >
            <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
            <html lang="en" xmlns="http://www.w3.org/1999/xhtml">
              <head>

                <meta charset="UTF-8">
                <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Garage Door is Open</title>
                <style type="text/css">
                  h1,h2,h3,h4,h5,h6 {
                  font-family:Arial,sans-serif;
                  }
                </style>
              </head>
              <body>
                <h1>Garage Door is Open  0sec</h1>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera4?api_password=3health1">
                <img style="width: 100%; alt="Image1 from Camera4" src="cid:snapshot_camera4_01cor.jpg" /></a>
                <h4>4 sec</h4>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera4?api_password=3health1">
                <img style="width: 100%; alt="Image2 from Camera4" src="cid:snapshot_camera4_02cor.jpg" /></a>
                <h4>16 sec</h4>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera4?api_password=3health1">
                <img style="width: 100%; alt="Image3 from Camera4" src="cid:snapshot_camera4_03cor.jpg" /></a>
                <h4>32 sec</h4>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera4?api_password=3health1">
                <img style="width: 100%; alt="Image3 from Camera4" src="cid:snapshot_camera4_04cor.jpg" /></a>
              </body>
            </html>
#
#
#
#
- id: 'BasementStairsLigt_Door' 
########################################################
## Basement StairsLigth "ON" if it was "OFF" triggered by 
## Door sensor ID:34 After that take 4 snapshoots and send
## them by mail "notify.mailtogmail" 
########################################################
  alias: Basement StairsLight Door_ON
  initial_state: true
  trigger:
    - entity_id: binary_sensor.kaipule_im20_doorwindow_sensor_sensor
      platform: state
      to: 'on'
  condition:
    - condition: state
      entity_id: switch.zooz_zen21_switch_v20_switch_01 
      state: 'off'
  action:
    - service: homeassistant.turn_on 
      entity_id: switch.zooz_zen21_switch_v20_switch_01 
    - delay: '00:00:02'
    - service: camera.snapshot
      data:
        entity_id: camera.camera5
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_01.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_01.jpg"
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_01cor.jpg"
    - delay: '00:00:10'
    - service: camera.snapshot
      data:
        entity_id: camera.camera5
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_02.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_02.jpg"
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_02cor.jpg"
    - delay: '00:00:20'
    - service: camera.snapshot
      data:
        entity_id: camera.camera5
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_03.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_03.jpg"
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_03cor.jpg"
    - delay: '00:00:30'
    - service: camera.snapshot
      data:
        entity_id: camera.camera5
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_04.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_04.jpg"
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_04cor.jpg"
    - service: notify.mailtogmail
      data_template:
        title: "Basement Motion Detected"
        message: "Motion Detected in Basement by Multisensor Multi01"
        data:
          images:
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera5_01cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera5_02cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera5_03cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera5_04cor.jpg
          html: >
            <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
            <html lang="en" xmlns="http://www.w3.org/1999/xhtml">
              <head>

                <meta charset="UTF-8">
                <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Switch1 Triggered</title>
                <style type="text/css">
                  h1,h2,h3,h4,h5,h6 {
                  font-family:Arial,sans-serif;
                  }
                </style>
              </head>
              <body>
                <h1>Motion in Basement  0sec</h1>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera5?api_password=3health1">
                <img style="width: 100%; alt="Image1 from Camera5" src="cid:snapshot_camera5_01cor.jpg" /></a>
                <h4>4 sec</h4>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera5?api_password=3health1">
                <img style="width: 100%; alt="Image2 from Camera5" src="cid:snapshot_camera5_02cor.jpg" /></a>
                <h4>16 sec</h4>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera5?api_password=3health1">
                <img style="width: 100%; alt="Image3 from Camera5" src="cid:snapshot_camera5_03cor.jpg" /></a>
                <h4>32 sec</h4>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera5?api_password=3health1">
                <img style="width: 100%; alt="Image3 from Camera5" src="cid:snapshot_camera5_04cor.jpg" /></a>
              </body>
            </html>
#
#
#
#
- id: 'BasementStairsLigt_Motion' 
########################################################
## Basement StairsLigth "ON" if it was "OFF" triggered by 
## Motion sensor ID:15 After that take 4 snapshoots and send
## them by mail "notify.mailtogmail" 
########################################################
  alias: Basement StairsLight Motion_ON
  initial_state: true
  trigger:
    - entity_id: binary_sensor.multi01_motion 
      platform: state
      to: 'on'
  condition:
    - condition: state
      entity_id: switch.zooz_zen21_switch_v20_switch_01 
      state: 'off'
  action:
    - service: homeassistant.turn_on 
      entity_id: switch.zooz_zen21_switch_v20_switch_01 
    - delay: '00:00:02'
    - service: camera.snapshot
      data:
        entity_id: camera.camera5
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_01.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_01.jpg"
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_01cor.jpg"
    - delay: '00:00:10'
    - service: camera.snapshot
      data:
        entity_id: camera.camera5
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_02.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_02.jpg"
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_02cor.jpg"
    - delay: '00:00:20'
    - service: camera.snapshot
      data:
        entity_id: camera.camera5
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_03.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_03.jpg"
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_03cor.jpg"
    - delay: '00:00:30'
    - service: camera.snapshot
      data:
        entity_id: camera.camera5
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_04.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_04.jpg"
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera5_04cor.jpg"
    - service: notify.mailtogmail
      data_template:
        title: "Basement Motion Detected"
        message: "Motion Detected in Basement by Multisensor Multi01"
        data:
          images:
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera5_01cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera5_02cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera5_03cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera5_04cor.jpg
          html: >
            <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
            <html lang="en" xmlns="http://www.w3.org/1999/xhtml">
              <head>

                <meta charset="UTF-8">
                <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Switch1 Triggered</title>
                <style type="text/css">
                  h1,h2,h3,h4,h5,h6 {
                  font-family:Arial,sans-serif;
                  }
                </style>
              </head>
              <body>
                <h1>Motion in Basement  0sec</h1>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera5?api_password=3health1">
                <img style="width: 100%; alt="Image1 from Camera5" src="cid:snapshot_camera5_01cor.jpg" /></a>
                <h4>4 sec</h4>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera5?api_password=3health1">
                <img style="width: 100%; alt="Image2 from Camera5" src="cid:snapshot_camera5_02cor.jpg" /></a>
                <h4>16 sec</h4>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera5?api_password=3health1">
                <img style="width: 100%; alt="Image3 from Camera5" src="cid:snapshot_camera5_03cor.jpg" /></a>
                <h4>32 sec</h4>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera5?api_password=3health1">
                <img style="width: 100%; alt="Image3 from Camera5" src="cid:snapshot_camera5_04cor.jpg" /></a>
              </body>
            </html>
#
#
- id: 'BasementLight_OFF_Closed'
########################################################
## Basement StairsLight "OFF" if it was "ON"
## after 2 minutes and "NO MOTION"
########################################################
  alias: Basement StairsLight 3min Closed_OFF
  initial_state: true
  trigger:
  - entity_id: switch.zooz_zen21_switch_v20_switch_01
    for:
      minutes: 2
    platform: state
    to: 'on'
  condition:
  - condition: state
    entity_id: binary_sensor.multi01_motion
    state: 'off'
  #- condition: state
  #  entity_id: switch.zooz_zen21_switch_v20_switch_01
  #  state: 'on'
  action:
  - service: homeassistant.turn_off
    entity_id: switch.zooz_zen21_switch_v20_switch_01
#
#
- id: 'BasementLight_OFF_Motion'
########################################################
## Basement StairsLight "OFF" if it was "ON" triggered by
## Multisensor1 after 15 minutes "NO MOTION"
##
########################################################
  alias: Basement StairsLight 3min Motion_OFF
  initial_state: true
  trigger:
  - entity_id: binary_sensor.multi01_motion
    for:
      minutes: 2
    platform: state
    to: 'off'
  condition:
  - condition: state
    entity_id: switch.zooz_zen21_switch_v20_switch_01
    state: 'on'
  action:
  - service: homeassistant.turn_off
    entity_id: switch.zooz_zen21_switch_v20_switch_01
#
#
#
- id: '2018073002' 
########################################################
## Turn switch Neo3 "OFF" if it was "ON" triggered by 
## Multisensor1 after 15 minutes "NO MOTION"
##  
########################################################
  alias: Turn off Neo3 3 minutes after last movement
  initial_state: true
  trigger:
  - entity_id: binary_sensor.multisensor2_motion
    for:
      minutes: 15
    platform: state
    to: 'off'
  condition:
  - condition: state
    entity_id: switch.neo_coolcam_power_plug_12a_switch_33
    state: 'on'
  action:
  - service: homeassistant.turn_off 
    entity_id: switch.neo_coolcam_power_plug_12a_switch_33
#
#
#
- id: 'MainFloor_Motion'
########################################################
## Triger by EZM01 ID 23 (MainFloor_Motion) 
## Take 4 snapshoots and send them by mail "notify.mailtogmail" 
## 
########################################################
  alias: Snapshots trigered by EZM01 ID:23
  initial_state: true
  trigger:
      ## Basemen Door ID: 36  
    - entity_id: binary_sensor.kaipule_im20_doorwindow_sensor_sensor
      platform: state
      from: 'off'
      to: 'on'
      ## Entrance Door ID:34   
    - entity_id: binary_sensor.kaipule_im20_doorwindow_sensor_sensor_2
      platform: state
      from: 'off'
      to: 'on'
      ## BackDoor ID:37   
    - entity_id: binary_sensor.kaipule_im20_doorwindow_sensor_sensor_3
      platform: state
      from: 'off'
      to: 'on'
 #  condition:
 #   - condition: state
 #     entity_id: binary_sensor.ezm01_motion
 #     state: 'on'
 #condition:
 #   - condition: time
 #     after: '14:30:00'
 #     before: '22:50:00'    
  action:
    - service: camera.snapshot
      data:
        entity_id: camera.camera1
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera1_01.jpg"
    - service: camera.snapshot
      data:
        entity_id: camera.camera7
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera7_01.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera7_01.jpg"  
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera7_01cor.jpg"  
    - delay: '00:00:02'
    - service: camera.snapshot
      data:
        entity_id: camera.camera1
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera1_02.jpg"
    - service: camera.snapshot
      data:
        entity_id: camera.camera7
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera7_02.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera7_02.jpg"  
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera7_02cor.jpg"  
    - delay: '00:00:12'
    - service: camera.snapshot
      data:
        entity_id: camera.camera1
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera1_03.jpg"
    - service: camera.snapshot
      data:
        entity_id: camera.camera7
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera7_03.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera7_03.jpg"  
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera7_03cor.jpg"  
    - delay: '00:00:25'
    - service: camera.snapshot
      data:
        entity_id: camera.camera1
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera1_04.jpg"
    - service: camera.snapshot
      data:
        entity_id: camera.camera7
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera7_04.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera7_04.jpg"  
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera7_04cor.jpg"  
    - service: notify.mailtogmail
      data_template:
        title: "MainFloor Motion detected"
        message: "MainFloor Motion detected"
        data:
          images:
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera1_01.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera1_02.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera1_03.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera1_04.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera7_01cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera7_02cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera7_03cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera7_04cor.jpg
          
          html: >
            <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
            <html lang="en" xmlns="http://www.w3.org/1999/xhtml">
              <head>
                <meta charset="UTF-8">
                <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>MainFloor Motion detected</title>
                <style type="text/css">
                  h1,h2,h3,h4,h5,h6 {
                  font-family:Arial,sans-serif;
                  }
                </style>
              </head>
              <body>
                <h1>MainFloor Motion detected (Camera1) 0sec</h1>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera1?api_password=3health1">
                <img style="width: 100%; alt="Image1 from Camera1" src="cid:snapshot_camera1_01.jpg" /></a>
                <h6>4 sec</h6>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera1?api_password=3health1">
                <img style="width: 100%; alt="Image2 from Camera1" src="cid:snapshot_camera1_02.jpg" /></a>
                <h6>16 sec</h6>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera1?api_password=3health1">
                <img style="width: 100%; alt="Image3 from Camera1" src="cid:snapshot_camera1_03.jpg" /></a>
                <h6>32 sec</h6>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera1?api_password=3health1">
                <img style="width: 100%; alt="Image3 from Camera1" src="cid:snapshot_camera1_04.jpg" /></a>
                <h1>MainFloor Motion detected (Camera2) 0sec</h1>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera7?api_password=3health1">
                <img style="width: 100%; alt="Image1 from Camera2" src="cid:snapshot_camera7_01cor.jpg" /></a>
                <h6>4 sec</h6>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera7?api_password=3health1">
                <img style="width: 100%; alt="Image2 from Camera2" src="cid:snapshot_camera7_02cor.jpg" /></a>
                <h6>16 sec</h6>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera7?api_password=3health1">
                <img style="width: 100%; alt="Image3 from Camera2" src="cid:snapshot_camera7_03cor.jpg" /></a>
                <h6>32 sec</h6>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera7?api_password=3health1">
                <img style="width: 100%; alt="Image3 from Camera2" src="cid:snapshot_camera7_04cor.jpg" /></a>
              </body>
            </html>
#
#
#
- id: 'MainDoor_Open'
########################################################
## Triger by MainDoor sensor Id:36 
## Take 4 snapshoots and send them by mail "notify.mailtogmail" 
## Camera #3 is "External Camera"
########################################################
  alias: Front Door is OPEN ID:36
  initial_state: true
  trigger:
      ## Main Door   
    - entity_id: binary_sensor.kaipule_im20_doorwindow_sensor_sensor_2
      platform: state
      from: 'off'
      to: 'on'
 #condition:
 #   - condition: time
 #     after: '14:30:00'
 #     before: '22:50:00'    
  action:
    - service: camera.snapshot
      data:
        entity_id: camera.camera3
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera3_01.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera3_01.jpg"  
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera3_01cor.jpg"  
    - delay: '00:00:05'
    - service: camera.snapshot
      data:
        entity_id: camera.camera3
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera3_02.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera3_02.jpg"  
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera3_02cor.jpg"  
    - delay: '00:00:15'
    - service: camera.snapshot
      data:
        entity_id: camera.camera3
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera3_03.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera3_03.jpg"  
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera3_03cor.jpg"  
    - delay: '00:00:25'
    - service: camera.snapshot
      data:
        entity_id: camera.camera3
        filename: "/home/homeassistant/.homeassistant/downloads/snapshot_camera3_04.jpg"
    - service: shell_command.fix_snapshot
      data:
        filename1: "/home/homeassistant/.homeassistant/downloads/snapshot_camera3_04.jpg"  
        filename2: "/home/homeassistant/.homeassistant/downloads/snapshot_camera3_04cor.jpg"  
    - service: notify.mailtogmail
      data_template:
        title: "Entrance Door was Open" 
        message: "Entrance Door was Open"
        data:
          images:
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera3_01cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera3_02cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera3_03cor.jpg
            - /home/homeassistant/.homeassistant/downloads/snapshot_camera3_04cor.jpg
          
          html: >
            <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
            <html lang="en" xmlns="http://www.w3.org/1999/xhtml">
              <head>
                <meta charset="UTF-8">
                <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Entrance Door Trigger</title>
                <style type="text/css">
                  h1,h2,h3,h4,h5,h6 {
                  font-family:Arial,sans-serif;
                  }
                </style>
              </head>
              <body>
                <h1>Entrance Door was Open (Camera3-External) 0sec</h1>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera3?api_password=3health1">
                <img style="width: 100%; alt="Image1 from Camera3" src="cid:snapshot_camera3_01cor.jpg" /></a>
                <h6>4 sec</h6>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera3?api_password=3health1">
                <img style="width: 100%; alt="Image2 from Camera3" src="cid:snapshot_camera3_02cor.jpg" /></a>
                <h6>16 sec</h6>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera3?api_password=3health1">
                <img style="width: 100%; alt="Image3 from Camera3" src="cid:snapshot_camera3_03cor.jpg" /></a>
                <h6>32 sec</h6>
                <a href="https://jumpier-panther-8852.dataplicity.io/api/camera_proxy_stream/camera.camera3?api_password=3health1">
                <img style="width: 100%; alt="Image3 from Camera3" src="cid:snapshot_camera3_04cor.jpg" /></a>
              </body>
            </html>
#
#
#
- id: '2018073004'
########################################################
## Turn Water Valve "OFF" if it was "ON" triggered by 
## Water Leak sensor from "OFF" to "ON". After that send
## an mail "notify.mailtogmail" 
########################################################
  alias: Auto_Switch_Water
  initial_state: true
  trigger:
  - entity_id: binary_sensor.neo_coolcam_water_leakage_detector_sensor01
    platform: state
    to: 'on'
  - entity_id: binary_sensor.neo_coolcam_water_leakage_detector_sensor02
    platform: state
    to: 'on'
  - entity_id: binary_sensor.neo_coolcam_water_leakage_detector_sensor03
    platform: state
    to: 'on'
  condition:
  - condition: state
    entity_id: switch.sigma_valveswitch01
    state: 'on'
  action:
  - service: homeassistant.turn_off
    entity_id: switch.sigma_valveswitch01
  - service: notify.mailtogmail
    data:
      title: "FLOOD ALERT"
      message: "WaterSwitch trigerred by WaterLeak sensor"
